class CountdownTimerWidget extends WidgetBase { getName() { return 'countdown_timer'; } getTitle() { return 'Countdown Timer'; } getIcon() { return 'fa fa-hourglass-half'; } getCategories() { return ['events']; } getKeywords() { return ['countdown', 'timer', 'event']; } registerControls() { this.startControlsSection('content_section', { label: 'Content', tab: 'content' }); this.addControl('title', { type: 'text', label: 'Title', default_value: 'Event Starts In', placeholder: 'Enter title', label_block: true }); this.addControl('target_date', { type: 'text', label: 'Target Date', default_value: 'Dec 31, 2024', placeholder: 'Enter date', label_block: true }); this.endControlsSection(); this.startControlsSection('style_section', { label: 'Style', tab: 'style' }); this.addControl('timer_color', { type: 'color', label: 'Timer Color', default_value: '#ef4444' }); this.endControlsSection(); this.registerAdvancedControls(); } render() { const title = this.getSetting('title', 'Event Starts In'); const targetDate = this.getSetting('target_date', 'Dec 31, 2024'); const timerColor = this.getSetting('timer_color', '#ef4444'); const cssClasses = this.getSetting('css_classes', ''); const cssId = this.getSetting('css_id', ''); const animation = this.getSetting('animation', 'none'); const animationDuration = this.getSetting('animation_duration', { size: 0.5, unit: 's' }); const animationDelay = this.getSetting('animation_delay', { size: 0, unit: 's' }); const safeAnimationDuration = (animationDuration && typeof animationDuration === 'object' && animationDuration.size !== undefined && animationDuration.unit !== undefined) ? animationDuration : { size: 0.5, unit: 's' }; const safeAnimationDelay = (animationDelay && typeof animationDelay === 'object' && animationDelay.size !== undefined && animationDelay.unit !== undefined) ? animationDelay : { size: 0, unit: 's' }; const units = [{ value: '15', label: 'Days' }, { value: '08', label: 'Hours' }, { value: '42', label: 'Minutes' }, { value: '30', label: 'Seconds' }].map(u => `<div style="text-align: center;"><div style="background: ${timerColor}; color: white; font-size: 36px; font-weight: 700; padding: 20px; border-radius: 8px; min-width: 80px;">${u.value}</div><div style="font-size: 14px; color: #666; margin-top: 8px; font-weight: 600;">${u.label}</div></div>`).join(''); const contentHtml = `<div style="text-align: center;"><h3 style="font-size: 24px; font-weight: 700; margin: 0 0 20px 0;">${this.escapeHtml(title)}</h3><div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">${units}</div><div style="font-size: 14px; color: #666; margin-top: 15px;">Until ${this.escapeHtml(targetDate)}</div></div>`; let wrapperClasses = ['countdown-timer-widget']; if (cssClasses) wrapperClasses.push(cssClasses); if (animation !== 'none') wrapperClasses.push('animated', animation); let wrapperAttributes = ''; if (cssId) wrapperAttributes += ` id="${this.escapeHtml(cssId)}"`; let animationStyles = ''; if (animation !== 'none') { const duration = `${safeAnimationDuration.size}${safeAnimationDuration.unit}`; const delay = `${safeAnimationDelay.size}${safeAnimationDelay.unit}`; animationStyles = `animation-name: ${animation}; animation-duration: ${duration}; animation-delay: ${delay}; animation-fill-mode: both;`; } const wrapperStyle = animationStyles ? ` style="${animationStyles.trim()}"` : ''; return `<div class="${wrapperClasses.join(' ')}"${wrapperAttributes}${wrapperStyle}>${contentHtml}</div>`; } escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; } }

window.elementorWidgetManager.registerWidget(CountdownTimerWidget);
