class GoogleReviewsWidget extends WidgetBase { getName() { return 'google_reviews'; } getTitle() { return 'Google Reviews'; } getIcon() { return 'fab fa-google'; } getCategories() { return ['social']; } getKeywords() { return ['google', 'reviews', 'ratings']; } registerControls() { this.startControlsSection('content_section', { label: 'Content', tab: 'content' }); this.addControl('business_name', { type: 'text', label: 'Business Name', default_value: 'My Business', placeholder: 'Enter business name', label_block: true }); this.addControl('rating', { type: 'text', label: 'Rating', default_value: '4.8', placeholder: 'e.g., 4.8' }); this.endControlsSection(); this.startControlsSection('style_section', { label: 'Style', tab: 'style' }); this.addControl('star_color', { type: 'color', label: 'Star Color', default_value: '#fbbc04' }); this.endControlsSection(); this.registerAdvancedControls(); } render() { const businessName = this.getSetting('business_name', 'My Business'); const rating = this.getSetting('rating', '4.8'); const starColor = this.getSetting('star_color', '#fbbc04'); const cssClasses = this.getSetting('css_classes', ''); const cssId = this.getSetting('css_id', ''); const animation = this.getSetting('animation', 'none'); const animationDuration = this.getSetting('animation_duration', { size: 0.5, unit: 's' }); const animationDelay = this.getSetting('animation_delay', { size: 0, unit: 's' }); const safeAnimationDuration = (animationDuration && typeof animationDuration === 'object' && animationDuration.size !== undefined && animationDuration.unit !== undefined) ? animationDuration : { size: 0.5, unit: 's' }; const safeAnimationDelay = (animationDelay && typeof animationDelay === 'object' && animationDelay.size !== undefined && animationDelay.unit !== undefined) ? animationDelay : { size: 0, unit: 's' }; const stars = Array.from({ length: 5 }, (_, i) => `<i class="fa fa-star" style="color: ${i < Math.floor(parseFloat(rating)) ? starColor : '#e5e7eb'}; font-size: 20px;"></i>`).join(''); const reviews = [1, 2, 3].map(i => `<div style="border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin-bottom: 10px;"><div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;"><div style="width: 40px; height: 40px; border-radius: 50%; background: #4285f4; display: flex; align-items: center; justify-content: center; color: white; font-weight: 600;">U</div><div><div style="font-size: 14px; font-weight: 600;">User ${i}</div><div style="font-size: 12px;">${stars}</div></div></div><p style="font-size: 14px; color: #666; margin: 0;">Great service and experience!</p></div>`).join(''); const contentHtml = `<div><div style="display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding: 20px; background: #f9fafb; border-radius: 12px;"><div style="width: 60px; height: 60px; border-radius: 50%; background: #4285f4; display: flex; align-items: center; justify-content: center; color: white; font-size: 28px;"><i class="fab fa-google"></i></div><div style="flex: 1;"><div style="font-size: 18px; font-weight: 700;">${this.escapeHtml(businessName)}</div><div style="display: flex; align-items: center; gap: 10px; margin-top: 5px;"><span style="font-size: 24px; font-weight: 700;">${this.escapeHtml(rating)}</span><div>${stars}</div></div></div></div>${reviews}</div>`; let wrapperClasses = ['google-reviews-widget']; if (cssClasses) wrapperClasses.push(cssClasses); if (animation !== 'none') wrapperClasses.push('animated', animation); let wrapperAttributes = ''; if (cssId) wrapperAttributes += ` id="${this.escapeHtml(cssId)}"`; let animationStyles = ''; if (animation !== 'none') { const duration = `${safeAnimationDuration.size}${safeAnimationDuration.unit}`; const delay = `${safeAnimationDelay.size}${safeAnimationDelay.unit}`; animationStyles = `animation-name: ${animation}; animation-duration: ${duration}; animation-delay: ${delay}; animation-fill-mode: both;`; } const wrapperStyle = animationStyles ? ` style="${animationStyles.trim()}"` : ''; return `<div class="${wrapperClasses.join(' ')}"${wrapperAttributes}${wrapperStyle}>${contentHtml}</div>`; } escapeHtml(text) { const div = document.createElement('div'); div.textContent = text; return div.innerHTML; } }

window.elementorWidgetManager.registerWidget(GoogleReviewsWidget);
